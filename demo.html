<html>

<style>

div {
	padding: 0;
	margin: 0;
}

body {
	font-size:9pt;
	font-family: Arial;
}

#input_panel {
	display: block;
	clear: both;
	width:800px;
}

#output_panel {
	display: none;
	clear:both;
	text-align: center;
	width: 800px;
}

#data_panel {
	display:table;
	float: left ;
	clear: both;
	width: 100%;
}

#data {
	width: 100%;
	height: 100px;
}

#param_panel {
	display:block;
	float: left;
	clear: both;
	width: 100%;
	margin-top: 10px;
}

#param_panel #params {
	display: table-cell;
}


#cluster_button {
	width: 100% ;
	height: 4em;
	display:table ;
}

</style>

<script type="text/javascript" src="figue.js"></script>


<script type="text/javascript">


var datasets = {
	'people': "anna,37,2\nkarin,65,3\njohn,34,2\ntom,38,5\nmarc,38,6\nstephany,38,3\n" ,
	'firms': "Microsoft,91259,60420\nIBM,400000,98787\nSkype,700,716\nSAP,48000,11567\nYahoo,14000,6426\neBay,15000,8700\n" ,
}


function updateDS() {
	var ds = document.getElementById('datasets').value ;
	if (ds in datasets)
		document.getElementById('data').value = datasets[ds] ;
	else
		document.getElementById('data').value = "" ;
}

function parseData(data) {
	var labels = new Array() ;
	var vectors = new Array() ;
	lines = data.split("\n") ;
	for (var i = 0 ; i < lines.length ; i++) {
		if (lines[i].length == 0)
			continue ;
		var elements = lines[i].split(",") ;
		var label = elements.shift() ;
		var vector = new Array() ;
		for (j = 0 ; j < elements.length ; j++)
			vector.push(parseFloat(elements[j])) ;
		vectors.push(vector) ;
		labels.push(label) ;
	}
	return {'labels': labels , 'vectors': vectors} ;
}

function test() {
	var data = parseData (document.getElementById('data').value) ;
	var space = parseInt (document.getElementById('space').value) ;
	var balanced = (radioValue('balanced') === 'true') ;
	var withLabel = (radioValue('withLabel') === 'true') ;
	var withCentroid = (radioValue('withCentroid') === 'true') ;
	var withDistance = (radioValue('withDistance') === 'true') ;
	var linkage = parseInt (radioValue('linkage')) ;
	root = figue.agglomerate(data['labels'], data['vectors'] , figue.EUCLIDIAN_DISTANCE, linkage) ;
	document.getElementById('output_panel').style.display = 'block' ;
	document.getElementById('text').innerHTML = root.buildDendogram(space, balanced, withLabel,withCentroid,withDistance)  ;
}

function radioValue(name) {
	var radios = document.getElementsByName(name) ;
	for (var i = 0 ; i < radios.length ; i++) 
		if (radios[i].checked) 
			return radios[i].value ;
}

</script>
<body onload="updateDS();">


<div id="input_panel">

<div id="data_panel">
<fieldset>
<legend>Data</legend>
Enter your data:
<textarea id="data">
</textarea>
<div style="margin-top:10px">
Or use an existing dataset:
<select id="datasets" onchange="updateDS();">
<option value="none">-</option>
<option value="people" selected>People (age, children)</option>
<option value="firms">Firms (size, revenue)</option>
</select>
</div>
</fieldset>
</div>

<div id="param_panel">
<fieldset id="params">
<legend>Control panel</legend>
Linkage method: 
<input type="radio" name="linkage" value="0" checked/>Single-linkage
<input type="radio" name="linkage" value="1" />Complete-linkage
<input type="radio" name="linkage" value="2" />Average-linkage<br/>
<br/>
Show labels:
<input type="radio" name="withLabel" value="true" checked/>Yes
<input type="radio" name="withLabel" value="false" />No <br/>
<br/>
Show centroids:
<input type="radio" name="withCentroid" value="true"/>Yes
<input type="radio" name="withCentroid" value="false"  checked/>No<br/>
<br/>
Show distance:
<input type="radio" name="withDistance" value="true"/>Yes
<input type="radio" name="withDistance" value="false"  checked/>No<br/>
<br/>
Balance dendogram:
<input type="radio" name="balanced" value="true" checked/>Yes
<input type="radio" name="balanced" value="false" />No <br/>
<br/>
Minimum spacing between nodes:
<select id="space">
<option value="3">3</option>
<option value="5">5</option>
<option value="7" selected="selected">7</option>
<option value="9">9</option>
</select>
</div>
</fieldset>

<div id="cluster_button" style="">
<div style="display:table-row; width:100%;text-align:center;">
<div style="vertical-align: middle; display:table-cell;">
<input type="button" onclick="test();" value="Cluster data and display dendogram" />
</div>
</div>
</div>


</div>


<div id="output_panel">
<fieldset>
<legend>Dendogram</legend>
<pre id="text"> </pre>
</fieldset>
</div>
</body>
</html>

